models:
  base_model: allenai/Llama-3.1-Tulu-3-8B-DPO
  sft_model: allenai/Llama-3.1-Tulu-3-8B-SFT
  rlvr_checkpoints:
  - step: 100
    path: allenai/Llama-3.1-Tulu-3-8B-step-400
    stage: early
  - step: 500
    path: allenai/Llama-3.1-Tulu-3-8B-step-1200
    stage: mid
  - step: 1000
    path: allenai/Llama-3.1-Tulu-3-8B
    stage: final
dataset:
  name: EleutherAI/hendrycks_math
  subjects:
  - all
  levels:
  - 3
  - 4
  split: test
  filter:
    dpo_correct: false
    rlvr_correct: true
  max_problems: 500
  seed: 42
rollout:
  num_samples_per_problem: 5
  generation:
    max_new_tokens: 2048
    temperature: 0.7
    top_p: 0.95
    do_sample: true
  save_dir: rollouts/dpo_errors
analysis:
  kl_divergence:
    compute_forward: true
    compute_reverse: true
    compute_js: true
    epsilon: 1e-10
  spike_detection:
    method: zscore
    threshold: 2.0
    min_spike_distance: 3
  entropy:
    compute: true
    normalize: true
  token_classification:
    enabled: true
    categories:
    - math_symbol
    - number
    - logical
    - step_marker
    - variable
    - other
baselines:
  dpo_vs_sft:
    enabled: true
  checkpoint_progression:
    enabled: true
    pairs:
    - - step_400
      - dpo
    - - step_1200
      - step_400
    - - step_2440
      - step_1200
visualization:
  output_dir: outputs/figures
  formats:
  - png
  - pdf
  dpi: 300
  heatmap:
    cmap: RdYlBu_r
    figsize:
    - 16
    - 8
  lineplot:
    figsize:
    - 14
    - 6
    show_spikes: true
    spike_color: red
  case_study:
    num_cases: 3
    detailed_analysis: true
metrics:
  aggregate:
  - mean_kl_by_checkpoint
  - spike_density_by_region
  - entropy_reduction_rate
  correlation:
    with_correctness: true
    with_problem_difficulty: true
  significance:
    test: wilcoxon
    alpha: 0.05
hardware:
  device: auto
  dtype: bfloat16
  batch_size: 4
  num_workers: 4
  multi_gpu:
    enabled: true
    gpu_ids:
    - 0
    - 4
    - 5
    max_memory_per_gpu: 40GB
logging:
  level: INFO
  save_logs: true
  log_dir: outputs/logs
seed: 42
